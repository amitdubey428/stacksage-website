{
  "account_id": "123456789012",
  "regions": [
    "us-east-1",
    "us-west-2"
  ],
  "findings": [
    {
      "type": "iam_root_mfa_disabled",
      "resource_type": "account",
      "severity": "critical",
      "confidence": 1.0,
      "id": "root",
      "region": null,
      "estimated_monthly_cost_usd": null,
      "estimated_monthly_savings_usd": 0,
      "recommended_action": "enable-root-mfa",
      "explanation": "Root MFA is not enabled. Enable MFA on the root user and restrict root usage.",
      "reason_codes": [
        "security_baseline",
        "cost_unknown"
      ],
      "evidence": {
        "iam": {
          "account_mfa_enabled": false
        },
        "inventory": {
          "resource_type": "account",
          "resource_id": "root"
        }
      },
      "remediation_commands": [],
      "verification_commands": [
        "aws iam get-account-summary --query 'SummaryMap.AccountMFAEnabled'"
      ]
    },
    {
      "type": "iam_root_access_keys_present",
      "resource_type": "account",
      "severity": "critical",
      "confidence": 1.0,
      "id": "root",
      "region": null,
      "estimated_monthly_cost_usd": null,
      "estimated_monthly_savings_usd": 0,
      "recommended_action": "remove-root-access-keys",
      "explanation": "Root access keys are present. Delete root access keys and use least-privilege IAM roles/users.",
      "reason_codes": [
        "security_baseline",
        "cost_unknown"
      ],
      "evidence": {
        "iam": {
          "root_access_keys_present": true
        },
        "inventory": {
          "resource_type": "account",
          "resource_id": "root"
        }
      },
      "remediation_commands": [],
      "verification_commands": [
        "aws iam get-account-summary --query 'SummaryMap.AccountAccessKeysPresent'"
      ]
    },
    {
      "type": "iam_password_policy_weak",
      "resource_type": "account",
      "severity": "medium",
      "confidence": 0.95,
      "id": "account",
      "region": null,
      "estimated_monthly_cost_usd": null,
      "estimated_monthly_savings_usd": 0,
      "recommended_action": "harden-iam-password-policy",
      "explanation": "IAM password policy is weaker than common baseline settings.",
      "reason_codes": [
        "security_baseline",
        "cost_unknown"
      ],
      "evidence": {
        "iam": {
          "password_policy_present": true,
          "issues": [
            "MinimumPasswordLength 10 < 14",
            "Missing complexity requirements (symbols/numbers/upper/lower)"
          ],
          "minimum_password_length": 10,
          "password_reuse_prevention": 0,
          "max_password_age": 180
        },
        "inventory": {
          "resource_type": "account",
          "resource_id": "account"
        }
      },
      "remediation_commands": [],
      "verification_commands": [
        "aws iam get-account-password-policy"
      ]
    },
    {
      "type": "cloudtrail_not_configured",
      "resource_type": "account",
      "severity": "high",
      "confidence": 0.9,
      "id": "account",
      "region": null,
      "estimated_monthly_cost_usd": null,
      "estimated_monthly_savings_usd": 0,
      "recommended_action": "enable-cloudtrail",
      "explanation": "CloudTrail baseline appears incomplete. Enable an org/account trail (multi-region) and ensure it is actively logging.",
      "reason_codes": [
        "audit_logging",
        "cost_unknown"
      ],
      "evidence": {
        "cloudtrail": {
          "regions_checked": [
            "us-east-1",
            "us-west-2"
          ],
          "trails_seen": 0,
          "multi_region_trails": 0,
          "logging_trails": 0,
          "log_file_validation_enabled_count": 0,
          "kms_encrypted_count": 0,
          "issues": [
            "No trails found",
            "No multi-region trail",
            "No trail appears to be actively logging"
          ]
        },
        "inventory": {
          "resource_type": "account",
          "resource_id": "account"
        }
      },
      "remediation_commands": [],
      "verification_commands": [
        "aws cloudtrail describe-trails",
        "aws cloudtrail get-trail-status --name <trail-name>"
      ]
    },
    {
      "type": "s3_account_public_access_block_disabled",
      "resource_type": "account",
      "severity": "high",
      "confidence": 0.9,
      "id": "account",
      "region": null,
      "estimated_monthly_cost_usd": null,
      "estimated_monthly_savings_usd": 0,
      "recommended_action": "enable-s3-block-public-access",
      "explanation": "S3 account-level Block Public Access is not fully enabled.",
      "reason_codes": [
        "public_exposure",
        "cost_unknown"
      ],
      "evidence": {
        "s3": {
          "account_public_access_block_missing": [
            "BlockPublicPolicy"
          ]
        },
        "inventory": {
          "resource_type": "account",
          "resource_id": "account"
        }
      },
      "remediation_commands": [],
      "verification_commands": [
        "aws s3control get-public-access-block --account-id 123456789012"
      ]
    },
    {
      "type": "sg_open_to_world",
      "resource_type": "security-group",
      "severity": "high",
      "confidence": 0.95,
      "id": "sg-0123abcd4567efgh8",
      "region": "us-east-1",
      "estimated_monthly_cost_usd": null,
      "estimated_monthly_savings_usd": 0,
      "recommended_action": "restrict-security-group-ingress",
      "explanation": "Security group allows inbound access from the public internet on sensitive ports.",
      "reason_codes": [
        "public_exposure",
        "cost_unknown"
      ],
      "evidence": {
        "network": {
          "exposures": [
            {
              "protocol": "tcp",
              "port": 22,
              "cidr": "world"
            },
            {
              "protocol": "tcp",
              "port": 5432,
              "cidr": "world"
            }
          ]
        },
        "inventory": {
          "resource_type": "security-group",
          "resource_id": "sg-0123abcd4567efgh8",
          "region": "us-east-1"
        }
      },
      "remediation_commands": [],
      "verification_commands": [
        "aws ec2 describe-security-groups --group-ids sg-0123abcd4567efgh8",
        "aws ec2 describe-security-group-rules --filters Name=group-id,Values=sg-0123abcd4567efgh8"
      ]
    },
    {
      "type": "guardduty_not_enabled",
      "resource_type": "account",
      "severity": "medium",
      "confidence": 0.8,
      "id": "account",
      "region": null,
      "estimated_monthly_cost_usd": null,
      "estimated_monthly_savings_usd": 0,
      "recommended_action": "enable-guardduty",
      "explanation": "GuardDuty is not enabled in one or more regions checked.",
      "reason_codes": [
        "audit_logging",
        "cost_unknown"
      ],
      "evidence": {
        "guardduty": {
          "regions_missing": [
            "us-west-2"
          ]
        },
        "inventory": {
          "resource_type": "account",
          "resource_id": "account"
        }
      },
      "remediation_commands": [],
      "verification_commands": [
        "aws guardduty list-detectors --region us-east-1",
        "aws guardduty list-detectors --region us-west-2"
      ]
    },
    {
      "type": "idle_ec2",
      "resource_type": "ec2",
      "severity": "critical",
      "confidence": 0.95,
      "id": "i-0123456789abcdef0",
      "region": "us-east-1",
      "instance_type": "t3.large",
      "cpu_avg": 2.1,
      "net_in_avg": 420000.0,
      "net_out_avg": 380000.0,
      "estimated_monthly_cost_usd": 62.4,
      "estimated_monthly_savings_usd": 62.4,
      "recommended_action": "consider-stopping-or-rightsize",
      "explanation": "Low CPU and low network usage over the lookback window.",
      "remediation_commands": [
        "aws ec2 stop-instances --instance-ids i-0123456789abcdef0"
      ],
      "verification_commands": [
        "aws cloudwatch get-metric-statistics --namespace AWS/EC2 --metric-name CPUUtilization --dimensions Name=InstanceId,Value=i-0123456789abcdef0 --start-time $(date -u -v-7d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 3600 --statistics Average",
        "aws cloudwatch get-metric-statistics --namespace AWS/EC2 --metric-name NetworkIn --dimensions Name=InstanceId,Value=i-0123456789abcdef0 --start-time $(date -u -v-7d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 3600 --statistics Average"
      ],
      "reason_codes": [
        "cw_metrics_measured"
      ],
      "evidence": {
        "cloudwatch": {
          "enabled": true,
          "lookback_days": 7,
          "metric_status": null,
          "errors": [],
          "budget": {
            "attempted": 15,
            "used": 12,
            "remaining": 3
          }
        },
        "inventory": {
          "resource_type": "ec2",
          "resource_id": "i-0123456789abcdef0",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "unattached_ebs",
      "resource_type": "ebs",
      "severity": "high",
      "confidence": 0.5,
      "id": "vol-0123456789abcdef",
      "region": "us-east-1",
      "size_gb": 100,
      "volume_type": "gp3",
      "estimated_monthly_cost_usd": 10.0,
      "estimated_monthly_savings_usd": 10.0,
      "recommended_action": "snapshot-and-delete",
      "explanation": "EBS volume (100 GB) unattached for >7 days. Create snapshot for safety, then delete if unused.",
      "remediation_commands": [
        "# Create snapshot before deleting:",
        "aws ec2 create-snapshot --volume-id vol-0123456789abcdef --description 'Backup before deletion'",
        "# Then delete volume:",
        "aws ec2 delete-volume --volume-id vol-0123456789abcdef"
      ],
      "verification_commands": [
        "aws ec2 describe-volumes --volume-ids vol-0123456789abcdef",
        "aws ec2 describe-volumes --filters Name=status,Values=available Name=volume-id,Values=vol-0123456789abcdef"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "ebs",
          "resource_id": "vol-0123456789abcdef",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "unattached_ebs",
      "resource_type": "ebs",
      "severity": "high",
      "confidence": 0.5,
      "id": "vol-fedcba9876543210",
      "region": "us-west-2",
      "size_gb": 500,
      "volume_type": "gp2",
      "estimated_monthly_cost_usd": 50.0,
      "estimated_monthly_savings_usd": 50.0,
      "recommended_action": "snapshot-and-delete",
      "explanation": "EBS volume (500 GB) unattached for >7 days. Create snapshot for safety, then delete if unused.",
      "remediation_commands": [
        "# Create snapshot before deleting:",
        "aws ec2 create-snapshot --volume-id vol-fedcba9876543210 --description 'Backup before deletion'",
        "# Then delete volume:",
        "aws ec2 delete-volume --volume-id vol-fedcba9876543210"
      ],
      "verification_commands": [
        "aws ec2 describe-volumes --volume-ids vol-fedcba9876543210",
        "aws ec2 describe-volumes --filters Name=status,Values=available Name=volume-id,Values=vol-fedcba9876543210"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "ebs",
          "resource_id": "vol-fedcba9876543210",
          "region": "us-west-2"
        }
      }
    },
    {
      "type": "gp2_to_gp3_migration",
      "resource_type": "ebs",
      "severity": "medium",
      "confidence": 0.5,
      "id": "vol-1111222233334444",
      "region": "us-east-1",
      "size_gb": 250,
      "estimated_monthly_cost_usd": 25.0,
      "estimated_monthly_savings_usd": 5.0,
      "recommended_action": "migrate-to-gp3",
      "explanation": "gp3 is typically cheaper than gp2 for similar workloads.",
      "remediation_commands": [
        "# Test in non-prod first, then migrate:",
        "aws ec2 modify-volume --volume-id vol-1111222233334444 --volume-type gp3",
        "# Monitor performance after migration:",
        "aws cloudwatch get-metric-statistics --namespace AWS/EBS --metric-name VolumeReadOps --dimensions Name=VolumeId,Value=vol-1111222233334444 --start-time $(date -u -v-1d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 300 --statistics Average"
      ],
      "verification_commands": [
        "aws ec2 describe-volumes --volume-ids vol-1111222233334444 --query 'Volumes[0].VolumeType'",
        "aws ec2 describe-volumes-modifications --volume-id vol-1111222233334444"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "ebs",
          "resource_id": "vol-1111222233334444",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "old_snapshot",
      "resource_type": "snapshot",
      "severity": "medium",
      "confidence": 0.5,
      "id": "snap-old123456789abc",
      "region": "us-west-2",
      "days_old": 964,
      "estimated_monthly_cost_usd": 25.0,
      "estimated_monthly_savings_usd": 25.0,
      "recommended_action": "delete-snapshot",
      "explanation": "Snapshot is older than the retention window.",
      "remediation_commands": [
        "aws ec2 delete-snapshot --snapshot-id snap-old123456789abc"
      ],
      "verification_commands": [
        "aws ec2 describe-snapshots --snapshot-ids snap-old123456789abc"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "snapshot",
          "resource_id": "snap-old123456789abc",
          "region": "us-west-2"
        }
      }
    },
    {
      "type": "cloudwatch_logs_retention",
      "resource_type": "cloudwatch",
      "severity": "medium",
      "confidence": 0.5,
      "id": "/aws/lambda/data-processor",
      "region": "us-east-1",
      "estimated_monthly_cost_usd": 15.0,
      "estimated_monthly_savings_usd": 9.0,
      "recommended_action": "set-logs-retention",
      "explanation": "Log group retention is set to Never Expire; set retention to reduce storage costs.",
      "remediation_commands": [],
      "verification_commands": [
        "aws logs describe-log-groups --log-group-name-prefix /aws/lambda/data-processor --query 'logGroups[0].retentionInDays'"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "cloudwatch",
          "resource_id": "/aws/lambda/data-processor",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "overprovisioned_lambda",
      "resource_type": "lambda",
      "severity": "low",
      "confidence": 0.5,
      "id": "data-transformer",
      "region": "us-east-1",
      "estimated_monthly_cost_usd": 12.0,
      "estimated_monthly_savings_usd": 3.0,
      "recommended_action": "reduce-lambda-memory",
      "explanation": "Execution time indicates memory may be over-provisioned. Estimated using measured invocations (~36,000/mo).",
      "invocations_avg_per_day": 1200,
      "invocations_estimated_per_month": 36000,
      "remediation_commands": [],
      "verification_commands": [
        "aws lambda get-function-configuration --function-name data-transformer --query 'MemorySize'",
        "aws cloudwatch get-metric-statistics --namespace AWS/Lambda --metric-name Duration --dimensions Name=FunctionName,Value=data-transformer --start-time $(date -u -v-7d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 3600 --statistics Average"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "lambda",
          "resource_id": "data-transformer",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "unused_eip",
      "resource_type": "eip",
      "severity": "medium",
      "confidence": 0.5,
      "id": "54.123.45.67",
      "region": "us-east-1",
      "estimated_monthly_cost_usd": 4.0,
      "estimated_monthly_savings_usd": 4.0,
      "recommended_action": "release-eip",
      "explanation": "Elastic IP is not attached to any instance; AWS charges for unused EIPs.",
      "remediation_commands": [
        "aws ec2 release-address --public-ip 54.123.45.67"
      ],
      "verification_commands": [
        "aws ec2 describe-addresses --public-ips 54.123.45.67"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "eip",
          "resource_id": "54.123.45.67",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "unused_eip",
      "resource_type": "eip",
      "severity": "medium",
      "confidence": 0.5,
      "id": "34.210.98.76",
      "region": "us-west-2",
      "estimated_monthly_cost_usd": 4.0,
      "estimated_monthly_savings_usd": 4.0,
      "recommended_action": "release-eip",
      "explanation": "Elastic IP is not attached to any instance; AWS charges for unused EIPs.",
      "remediation_commands": [
        "aws ec2 release-address --public-ip 34.210.98.76"
      ],
      "verification_commands": [
        "aws ec2 describe-addresses --public-ips 34.210.98.76"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "eip",
          "resource_id": "34.210.98.76",
          "region": "us-west-2"
        }
      }
    },
    {
      "type": "nat_gateway",
      "resource_type": "nat",
      "severity": "low",
      "confidence": 0.7,
      "id": "nat-0123456789abcdef",
      "region": "us-east-1",
      "estimated_monthly_cost_usd": 32.85,
      "adjusted_monthly_cost_usd": 32.85,
      "estimated_monthly_savings_usd": 0.0,
      "recommended_action": "review-and-consider-vpc-endpoint",
      "explanation": "NAT gateways have hourly + data processing cost; if used primarily for S3, consider an S3 VPC endpoint.",
      "estimation_method": "base_hourly+uptime",
      "assumptions": [
        "no data processing included",
        "uptime estimated from CreateTime",
        "regional multiplier applied via pricing tables"
      ],
      "remediation_commands": [],
      "verification_commands": [
        "aws ec2 describe-nat-gateways --nat-gateway-ids nat-0123456789abcdef",
        "aws ec2 describe-route-tables --filters Name=route.nat-gateway-id,Values=nat-0123456789abcdef"
      ],
      "reason_codes": [
        "cost_estimated"
      ],
      "evidence": {
        "estimation": {
          "method": "base_hourly+uptime",
          "assumptions": [
            "no data processing included",
            "uptime estimated from CreateTime",
            "regional multiplier applied via pricing tables"
          ],
          "adjusted_monthly_cost_usd": 32.85
        },
        "inventory": {
          "resource_type": "nat",
          "resource_id": "nat-0123456789abcdef",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "idle_nat_gateway",
      "resource_type": "nat",
      "severity": "medium",
      "confidence": 0.5,
      "id": "nat-0123456789abcdef",
      "region": "us-east-1",
      "estimated_monthly_cost_usd": 32.85,
      "adjusted_monthly_cost_usd": 32.85,
      "estimated_monthly_savings_usd": 32.85,
      "recommended_action": "review-and-delete-if-unused",
      "explanation": "NAT gateway shows very low data processed (~0.25 GB/day across last 14 days). If unused, consider deleting to save hourly charges.",
      "bytes_out_avg_per_day": 134217728,
      "bytes_in_avg_per_day": 134217728,
      "remediation_commands": [],
      "verification_commands": [
        "aws ec2 describe-nat-gateways --nat-gateway-ids nat-0123456789abcdef",
        "aws cloudwatch get-metric-statistics --namespace AWS/NATGateway --metric-name BytesOutToDestination --dimensions Name=NatGatewayId,Value=nat-0123456789abcdef --start-time $(date -u -v-14d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 86400 --statistics Sum",
        "aws cloudwatch get-metric-statistics --namespace AWS/NATGateway --metric-name BytesInFromSource --dimensions Name=NatGatewayId,Value=nat-0123456789abcdef --start-time $(date -u -v-14d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 86400 --statistics Sum"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "nat",
          "resource_id": "nat-0123456789abcdef",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "idle_elb",
      "resource_type": "elb",
      "severity": "high",
      "confidence": 0.9,
      "id": "my-alb-prod",
      "region": "us-east-1",
      "estimated_monthly_cost_usd": 25.0,
      "estimated_monthly_savings_usd": 25.0,
      "recommended_action": "review-and-delete-if-unused",
      "explanation": "Low request count over the lookback window.",
      "request_count_avg": 3.0,
      "remediation_commands": [],
      "verification_commands": [
        "aws cloudwatch get-metric-statistics --namespace AWS/ApplicationELB --metric-name RequestCount --dimensions Name=LoadBalancer,Value=app/my-alb-prod/1234567890abcdef --start-time $(date -u -v-7d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 86400 --statistics Sum"
      ],
      "reason_codes": [
        "cw_metrics_measured"
      ],
      "evidence": {
        "cloudwatch": {
          "enabled": true,
          "lookback_days": 7,
          "metric_status": null,
          "errors": [],
          "budget": {
            "attempted": 15,
            "used": 12,
            "remaining": 3
          }
        },
        "inventory": {
          "resource_type": "elb",
          "resource_id": "my-alb-prod",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "idle_elb",
      "resource_type": "elb",
      "severity": "low",
      "confidence": 0.35,
      "id": "my-alb-staging",
      "region": "us-west-2",
      "estimated_monthly_cost_usd": 0.0,
      "estimated_monthly_savings_usd": 0.0,
      "recommended_action": "review-lb-usage",
      "explanation": "Unable to measure load balancer request volume: CloudWatch returned no datapoints for the lookback window.",
      "remediation_commands": [],
      "metrics_error": "cw_error:AWS/ApplicationELB:RequestCount:no_data",
      "cw_metrics": [
        {
          "namespace": "AWS/ApplicationELB",
          "metric": "RequestCount",
          "statistic": "Sum",
          "period": 86400,
          "days": 7,
          "region": "us-west-2",
          "status": "no_data",
          "datapoints": 0
        }
      ],
      "verification_commands": [
        "aws cloudwatch get-metric-statistics --namespace AWS/ApplicationELB --metric-name RequestCount --dimensions Name=LoadBalancer,Value=app/my-alb-staging/abcdef1234567890 --start-time $(date -u -v-7d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 86400 --statistics Sum"
      ],
      "reason_codes": [
        "cw_no_data"
      ],
      "evidence": {
        "cloudwatch": {
          "enabled": true,
          "lookback_days": 7,
          "metric_status": null,
          "errors": [
            "cw_error:AWS/ApplicationELB:RequestCount:no_data"
          ],
          "metrics": [
            {
              "namespace": "AWS/ApplicationELB",
              "metric": "RequestCount",
              "statistic": "Sum",
              "period": 86400,
              "days": 7,
              "region": "us-west-2",
              "status": "no_data",
              "datapoints": 0
            }
          ],
          "datapoints_total": 0,
          "budget": {
            "attempted": 15,
            "used": 12,
            "remaining": 3
          }
        },
        "inventory": {
          "resource_type": "elb",
          "resource_id": "my-alb-staging",
          "region": "us-west-2"
        }
      }
    },
    {
      "type": "underutilized_rds",
      "resource_type": "rds",
      "severity": "medium",
      "confidence": 0.75,
      "id": "prod-postgres-db",
      "region": "us-east-1",
      "engine": "postgres",
      "instance_class": "db.t3.large",
      "recommended_instance_class": "db.t3.medium",
      "estimated_monthly_cost_usd": 156.0,
      "estimated_monthly_savings_usd": 78.0,
      "recommended_action": "review-and-rightsize",
      "explanation": "Metric query skipped due to budget exhaustion",
      "metric_status": "skipped_budget",
      "remediation_commands": [],
      "verification_commands": [
        "aws rds describe-db-instances --db-instance-identifier prod-postgres-db",
        "aws cloudwatch get-metric-statistics --namespace AWS/RDS --metric-name CPUUtilization --dimensions Name=DBInstanceIdentifier,Value=prod-postgres-db --start-time $(date -u -v-7d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 3600 --statistics Average"
      ],
      "reason_codes": [
        "cw_budget_exhausted"
      ],
      "evidence": {
        "cloudwatch": {
          "enabled": true,
          "lookback_days": 7,
          "metric_status": "skipped_budget",
          "errors": [],
          "budget": {
            "attempted": 15,
            "used": 12,
            "remaining": 3
          }
        },
        "inventory": {
          "resource_type": "rds",
          "resource_id": "prod-postgres-db",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "underutilized_rds",
      "resource_type": "rds",
      "severity": "low",
      "confidence": 0.3,
      "id": "analytics-postgres-db",
      "region": "us-east-1",
      "engine": "postgres",
      "instance_class": "db.t3.large",
      "estimated_monthly_cost_usd": 0.0,
      "estimated_monthly_savings_usd": 0.0,
      "recommended_action": "review-and-rightsize",
      "explanation": "Unable to measure CPU/storage utilization: missing CloudWatch permissions (AccessDenied).",
      "remediation_commands": [],
      "metrics_error": "cw_error:AWS/RDS:CPUUtilization:not_authorized",
      "cw_metrics": [
        {
          "namespace": "AWS/RDS",
          "metric": "CPUUtilization",
          "statistic": "Average",
          "period": 300,
          "days": 7,
          "region": "us-east-1",
          "status": "error",
          "classification": "not_authorized"
        }
      ],
      "verification_commands": [
        "aws rds describe-db-instances --db-instance-identifier analytics-postgres-db",
        "aws cloudwatch get-metric-statistics --namespace AWS/RDS --metric-name CPUUtilization --dimensions Name=DBInstanceIdentifier,Value=analytics-postgres-db --start-time $(date -u -v-7d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 3600 --statistics Average"
      ],
      "reason_codes": [
        "cw_not_authorized"
      ],
      "evidence": {
        "cloudwatch": {
          "enabled": true,
          "lookback_days": 7,
          "metric_status": null,
          "errors": [
            "cw_error:AWS/RDS:CPUUtilization:not_authorized"
          ],
          "metrics": [
            {
              "namespace": "AWS/RDS",
              "metric": "CPUUtilization",
              "statistic": "Average",
              "period": 300,
              "days": 7,
              "region": "us-east-1",
              "status": "error",
              "classification": "not_authorized"
            }
          ],
          "datapoints_total": 0,
          "budget": {
            "attempted": 15,
            "used": 12,
            "remaining": 3
          }
        },
        "inventory": {
          "resource_type": "rds",
          "resource_id": "analytics-postgres-db",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "rds_low_connections",
      "resource_type": "rds",
      "severity": "medium",
      "confidence": 0.5,
      "id": "reporting-postgres-db",
      "region": "us-east-1",
      "engine": "postgres",
      "instance_class": "db.t3.medium",
      "estimated_monthly_cost_usd": 120.0,
      "estimated_monthly_savings_usd": 120.0,
      "recommended_action": "review-and-stop-if-unused",
      "explanation": "Average connections 0.3 over 14 days. Review whether this instance is still needed.",
      "remediation_commands": [],
      "verification_commands": [
        "aws rds describe-db-instances --db-instance-identifier reporting-postgres-db",
        "aws cloudwatch get-metric-statistics --namespace AWS/RDS --metric-name DatabaseConnections --dimensions Name=DBInstanceIdentifier,Value=reporting-postgres-db --start-time $(date -u -v-14d '+%Y-%m-%dT%H:%M:%S') --end-time $(date -u '+%Y-%m-%dT%H:%M:%S') --period 300 --statistics Average"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "rds",
          "resource_id": "reporting-postgres-db",
          "region": "us-east-1"
        }
      }
    },
    {
      "type": "old_snapshot",
      "resource_type": "snapshot",
      "severity": "low",
      "confidence": 0.5,
      "id": "snap-0123456789abcdef",
      "region": "us-east-1",
      "days_old": 668,
      "estimated_monthly_cost_usd": 5.0,
      "estimated_monthly_savings_usd": 5.0,
      "recommended_action": "delete-snapshot",
      "explanation": "Snapshot is older than the retention window.",
      "remediation_commands": [
        "aws ec2 delete-snapshot --snapshot-id snap-0123456789abcdef"
      ],
      "verification_commands": [
        "aws ec2 describe-snapshots --snapshot-ids snap-0123456789abcdef"
      ],
      "reason_codes": [
        "heuristic",
        "evidence_limited"
      ],
      "evidence": {
        "inventory": {
          "resource_type": "snapshot",
          "resource_id": "snap-0123456789abcdef",
          "region": "us-east-1"
        }
      }
    }
  ],
  "estimated_monthly_cost": 579.1,
  "estimated_monthly_savings": 433.25,
  "provenance": {
    "cloudwatch_metrics": true,
    "metrics_lookback_days": 7,
    "cloudwatch_queries_attempted": 15,
    "cloudwatch_queries_used": 12,
    "cloudwatch_queries_remaining": 3,
    "cloudwatch_budget_exhausted": false
  },
  "historical_costs": {
    "time_window": {
      "start": "2025-11-01",
      "end": "2025-12-01"
    },
    "granularity": "MONTHLY",
    "total_unblended_cost": 1240.55,
    "breakdown_by_service_region": {
      "Amazon EC2": {
        "us-east-1": 420.12,
        "us-west-2": 110.05
      },
      "Amazon RDS": {
        "us-east-1": 260.34
      },
      "Amazon S3": {
        "us-east-1": 75.22,
        "us-west-2": 18.1
      },
      "Amazon CloudWatch": {
        "us-east-1": 44.9
      },
      "AWS NAT Gateway": {
        "us-east-1": 95.0
      }
    }
  },
  "spend_movers": {
    "time_window": {
      "current": {
        "start": "2025-12-24",
        "end": "2025-12-31"
      },
      "previous": {
        "start": "2025-12-17",
        "end": "2025-12-24"
      }
    },
    "granularity": "DAILY",
    "lookback_days": 7,
    "compare_days": 7,
    "min_delta_usd": 5.0,
    "total_current": 410.25,
    "total_previous": 360.1,
    "total_delta": 50.15,
    "total_pct_change": 13.92,
    "top_increases_by_service": [
      {
        "key": "Amazon EC2",
        "current_cost": 160.2,
        "previous_cost": 120.1,
        "delta": 40.1,
        "pct_change": 33.39,
        "new_spend": false,
        "stopped_spend": false
      },
      {
        "key": "Amazon S3",
        "current_cost": 35.0,
        "previous_cost": 20.0,
        "delta": 15.0,
        "pct_change": 75.0,
        "new_spend": false,
        "stopped_spend": false
      }
    ],
    "top_decreases_by_service": [
      {
        "key": "Amazon CloudWatch",
        "current_cost": 8.0,
        "previous_cost": 15.5,
        "delta": -7.5,
        "pct_change": -48.39,
        "new_spend": false,
        "stopped_spend": false
      }
    ],
    "top_increases_by_region": [
      {
        "key": "us-east-1",
        "current_cost": 300.0,
        "previous_cost": 255.0,
        "delta": 45.0,
        "pct_change": 17.65,
        "new_spend": false,
        "stopped_spend": false
      }
    ],
    "top_decreases_by_region": [
      {
        "key": "us-west-2",
        "current_cost": 110.25,
        "previous_cost": 105.1,
        "delta": 5.15,
        "pct_change": 4.9,
        "new_spend": false,
        "stopped_spend": false
      }
    ]
  }
}