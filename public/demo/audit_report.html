<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>StackSage Cloud Audit Report</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f5f7fa;
      padding: 20px;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 40px;
    }
    h1 {
      color: #1976d2;
      font-size: 32px;
      margin-bottom: 8px;
    }
    h2 {
      color: #424242;
      font-size: 24px;
      margin-top: 32px;
      margin-bottom: 16px;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 8px;
    }
    h3 {
      color: #616161;
      font-size: 18px;
      margin-top: 24px;
      margin-bottom: 12px;
    }
    
    /* Executive Dashboard Cards */
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin: 24px 0 32px 0;
    }
    .card {
      padding: 24px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12);
    }
    .card-savings {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    .card-issues {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }
    .card-priority {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      color: white;
    }
    .card-waste {
      background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
      color: white;
    }
    .card-value {
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 8px;
    }
    .card-label {
      font-size: 14px;
      opacity: 0.9;
    }
    
    /* Metadata section */
    .metadata {
      background: #f5f5f5;
      padding: 16px;
      border-radius: 6px;
      margin: 16px 0;
      font-size: 14px;
    }
    .metadata strong {
      color: #424242;
    }
    
    /* Badges */
    .badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      margin-left: 8px;
    }
    .badge-critical {
      background: #f44336;
      color: white;
    }
    .badge-high {
      background: #ff9800;
      color: white;
    }
    .badge-medium {
      background: #ffc107;
      color: #000;
    }
    .badge-low {
      background: #8bc34a;
      color: white;
    }
    .badge-info {
      background: #e0e0e0;
      color: #616161;
      border: 1px solid #bdbdbd;
    }
    .badge-skipped {
      background: #ffebee;
      color: #c62828;
      border: 1px solid #ffcdd2;
    }
    
    /* Provenance badges */
    .provenance-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      margin-right: 8px;
      border: 1px solid;
    }
    .badge-cloudwatch {
      background: #e3f2fd;
      border-color: #90caf9;
      color: #1565c0;
    }
    .badge-cost-explorer {
      background: #fff3e0;
      border-color: #ffcc80;
      color: #e65100;
    }
    .badge-live-pricing {
      background: #f1f8e9;
      border-color: #aed581;
      color: #33691e;
    }
    .badge-heuristic {
      background: #f5f5f5;
      border-color: #e0e0e0;
      color: #757575;
    }

    /* Scorecard statuses */
    .scorecard-status {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
    }
    .scorecard-pass {
      background: #e8f5e9;
      color: #2e7d32;
      border: 1px solid #c8e6c9;
    }
    .scorecard-fail {
      background: #ffebee;
      color: #c62828;
      border: 1px solid #ffcdd2;
    }
    .scorecard-unknown {
      background: #fff8e1;
      color: #f9a825;
      border: 1px solid #ffecb3;
    }

    /* Instant tooltips (avoid browser title delay) */
    .tip {
      position: relative;
      display: inline-block;
    }
    .tip .tiptext {
      visibility: hidden;
      opacity: 0;
      position: absolute;
      z-index: 1000;
      left: 0;
      transform: none;
      bottom: 125%;
      min-width: 220px;
      max-width: 360px;
      padding: 8px 10px;
      border-radius: 6px;
      background: #424242;
      color: white;
      font-size: 12px;
      line-height: 1.4;
      text-align: left;
      white-space: normal;
      transition: opacity 0s;
      pointer-events: none;
    }
    .tip:hover .tiptext {
      visibility: visible;
      opacity: 1;
    }
    
    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0;
      font-size: 14px;
    }
    th, td {
      border: 1px solid #e0e0e0;
      padding: 12px;
      text-align: left;
    }
    th {
      background: #f5f5f5;
      font-weight: 600;
      color: #424242;
    }
    tr:hover {
      background: #fafafa;
    }
    .severity-critical {
      background-color: #ffebee;
    }
    .severity-high {
      background-color: #fff3e0;
    }
    .severity-medium {
      background-color: #fffde7;
    }
    .severity-low {
      background-color: #f1f8e9;
    }
    
    /* Charts */
    .chart-container {
      max-width: 600px;
      margin: 24px auto;
      padding: 20px;
      background: #fafafa;
      border-radius: 8px;
    }
    
    /* Collapsible sections */
    .collapsible {
      background-color: #f5f5f5;
      color: #424242;
      cursor: pointer;
      padding: 14px;
      border: none;
      text-align: left;
      width: 100%;
      font-size: 16px;
      font-weight: 600;
      border-radius: 6px;
      margin-top: 16px;
      transition: background-color 0.3s;
    }
    .collapsible:hover {
      background-color: #e0e0e0;
    }
    .collapsible:after {
      content: '\002B';
      font-weight: bold;
      float: right;
      font-size: 18px;
    }
    .collapsible.active:after {
      content: '\2212';
    }
    .content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
      background: white;
    }
    .content.expanded {
      overflow: visible;
    }

    /* CLI code blocks + copy */
    .codeblock {
      position: relative;
      background: #0f172a;
      color: #e2e8f0;
      border-radius: 8px;
      padding: 12px 12px 12px 12px;
      margin-top: 8px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      line-height: 1.5;
      border: 1px solid #1e293b;
      cursor: pointer;
    }
    .codeblock code {
      white-space: pre-wrap;
      display: block;
    }
    .copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: #1e293b;
      color: #e2e8f0;
      border: 1px solid #334155;
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
    }
    .copy-btn.copied {
      background: #0ea5e9;
      border-color: #0ea5e9;
      color: #fff;
    }
    
    /* Priority boxes */
    .priority-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin: 24px 0;
    }
    .priority-box {
      border: 2px solid;
      padding: 20px;
      border-radius: 8px;
    }
    .priority-box.critical {
      border-color: #f44336;
      background: #ffebee;
    }
    .priority-box.high {
      border-color: #ff9800;
      background: #fff3e0;
    }
    .priority-box h3 {
      margin-top: 0;
      margin-bottom: 12px;
    }
    .priority-box ul {
      margin-left: 20px;
    }
    .priority-box li {
      margin-bottom: 8px;
    }
    
    /* Footer */
    .footer {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #e0e0e0;
      font-size: 12px;
      color: #757575;
    }
    
    @media (max-width: 768px) {
      .container {
        padding: 20px;
      }
      .dashboard {
        grid-template-columns: 1fr;
      }
      .priority-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>StackSage ‚Äî Cloud Cost Audit Report</h1>
    
    <div class="metadata">
      <strong>Account:</strong> 123456789012 | 
      <strong>Regions:</strong> us-east-1, us-west-2 | 
      <strong>Generated:</strong> 2026-02-01 18:50:48 UTC
      | <strong>Pricing:</strong> v2025-12
    </div>
    
    <!-- Executive Dashboard -->
    <h2>Executive Dashboard</h2>
    <div class="dashboard">
      <div class="card card-savings">
        <div class="card-value">$280.4</div>
        <div class="card-label">Potential Savings/Month</div>
      </div>
      
      <div class="card card-issues">
        <div class="card-value">22</div>
        <div class="card-label">Issues Found</div>
      </div>
      
      <div class="card card-priority">
        <div class="card-value">
          9
        </div>
        <div class="card-label">High Priority Items</div>
      </div>
      
      <div class="card card-waste">
        <div class="card-value">
          
            66%
          
        </div>
        <div class="card-label">Potential Waste</div>
      </div>
    </div>
    
    <p style="font-size: 14px; color: #616161; margin: 16px 0;">
      <strong>Estimated Monthly Cost:</strong> $426.25
    </p>
    
      
    <p style="margin: 16px 0;">
      <strong>Data Sources:</strong><br>
      
        <span class="provenance-badge badge-cloudwatch" title="CloudWatch aggregates (Average CPU/RequestCount only)">
          üìä Live Metrics (CloudWatch, 7d)
        </span>
      
      
        <span class="provenance-badge badge-cost-explorer" title="Cost Explorer spend summary (service/region totals)">
          üí∞ Cost Explorer Data
        </span>
      
      
      
        <span class="provenance-badge badge-info" title="CloudWatch queries: attempted/used/remaining">
          CW Queries: 15/12/3
        </span>
      
    </p>
    
    
    
    <p style="font-size: 14px; color: #616161; margin: 16px 0;">
      <strong>Historical Spend (2025-11-01 ‚Üí 2025-12-01):</strong> $1240.55
    </p>
    

    
    <h3>üí∞ Historical Spend Breakdown (Top)</h3>
    <div style="display: flex; gap: 16px; flex-wrap: wrap; margin: 12px 0 20px 0;">
      <div style="flex: 1; min-width: 280px;">
        <div style="font-size: 13px; color: #616161; margin-bottom: 6px;"><strong>Top Services</strong></div>
        <table>
          <thead>
            <tr>
              <th>Service</th>
              <th>Cost (USD)</th>
            </tr>
          </thead>
          <tbody>
            
            <tr>
              <td>Amazon EC2</td>
              <td>$530.17</td>
            </tr>
            
            <tr>
              <td>Amazon RDS</td>
              <td>$260.34</td>
            </tr>
            
            <tr>
              <td>AWS NAT Gateway</td>
              <td>$95.0</td>
            </tr>
            
            <tr>
              <td>Amazon S3</td>
              <td>$93.32</td>
            </tr>
            
            <tr>
              <td>Amazon CloudWatch</td>
              <td>$44.9</td>
            </tr>
            
          </tbody>
        </table>
      </div>

      
      <div style="flex: 1; min-width: 280px;">
        <div style="font-size: 13px; color: #616161; margin-bottom: 6px;"><strong>Top Regions</strong></div>
        <table>
          <thead>
            <tr>
              <th>Region</th>
              <th>Cost (USD)</th>
            </tr>
          </thead>
          <tbody>
            
            <tr>
              <td>us-east-1</td>
              <td>$895.58</td>
            </tr>
            
            <tr>
              <td>us-west-2</td>
              <td>$128.15</td>
            </tr>
            
          </tbody>
        </table>
      </div>
      
    </div>
    

    
    <h3>üìà Spend Movers (2025-12-17 ‚Üí 2025-12-24 vs 2025-12-24 ‚Üí 2025-12-31)</h3>
    <p style="font-size: 13px; color: #616161; margin: 6px 0 12px 0;">
      Aggregated deltas only. Threshold: $5.0. Totals changed by $50.15 (13.92%).
    </p>
    <div style="display: flex; gap: 16px; flex-wrap: wrap; margin: 12px 0 20px 0;">
      
      <div style="flex: 1; min-width: 280px;">
        <div style="font-size: 13px; color: #616161; margin-bottom: 6px;"><strong>Top Service Increases</strong></div>
        <table>
          <thead>
            <tr>
              <th>Service</th>
              <th>Œî (USD)</th>
              <th>Change</th>
            </tr>
          </thead>
          <tbody>
            
            <tr>
              <td>Amazon EC2</td>
              <td style="color: #2e7d32; font-weight: 600;">$40.1</td>
              <td>
                
                  33.39%
                
              </td>
            </tr>
            
            <tr>
              <td>Amazon S3</td>
              <td style="color: #2e7d32; font-weight: 600;">$15.0</td>
              <td>
                
                  75.0%
                
              </td>
            </tr>
            
          </tbody>
        </table>
      </div>
      

      
      <div style="flex: 1; min-width: 280px;">
        <div style="font-size: 13px; color: #616161; margin-bottom: 6px;"><strong>Top Service Decreases</strong></div>
        <table>
          <thead>
            <tr>
              <th>Service</th>
              <th>Œî (USD)</th>
              <th>Change</th>
            </tr>
          </thead>
          <tbody>
            
            <tr>
              <td>Amazon CloudWatch</td>
              <td style="color: #c62828; font-weight: 600;">$-7.5</td>
              <td>
                
                  -48.39%
                
              </td>
            </tr>
            
          </tbody>
        </table>
      </div>
      
    </div>

    <div style="display: flex; gap: 16px; flex-wrap: wrap; margin: 12px 0 20px 0;">
      
      <div style="flex: 1; min-width: 280px;">
        <div style="font-size: 13px; color: #616161; margin-bottom: 6px;"><strong>Top Region Increases</strong></div>
        <table>
          <thead>
            <tr>
              <th>Region</th>
              <th>Œî (USD)</th>
              <th>Change</th>
            </tr>
          </thead>
          <tbody>
            
            <tr>
              <td>us-east-1</td>
              <td style="color: #2e7d32; font-weight: 600;">$45.0</td>
              <td>
                
                  17.65%
                
              </td>
            </tr>
            
          </tbody>
        </table>
      </div>
      

      
      <div style="flex: 1; min-width: 280px;">
        <div style="font-size: 13px; color: #616161; margin-bottom: 6px;"><strong>Top Region Decreases</strong></div>
        <table>
          <thead>
            <tr>
              <th>Region</th>
              <th>Œî (USD)</th>
              <th>Change</th>
            </tr>
          </thead>
          <tbody>
            
            <tr>
              <td>us-west-2</td>
              <td style="color: #c62828; font-weight: 600;">$5.15</td>
              <td>
                
                  4.9%
                
              </td>
            </tr>
            
          </tbody>
        </table>
      </div>
      
    </div>
    

    <!-- Executive Summary -->
    <h2>Executive Summary</h2>
    <p style="font-size: 15px; line-height: 1.8; color: #424242;">Potential monthly savings: $280.40. Current cost (flagged resources): $426.25. Primary drivers: underutilized_rds(prod-postgres-db): $78.00, idle_ec2(i-0123456789abcdef0): $62.40, unattached_ebs(vol-fedcba9876543210): $50.00, old_snapshot(snap-old123456789abc): $25.00, idle_elb(my-alb-prod): $25.00</p>

    
    <h3>üõ°Ô∏è Security Posture Scorecard</h3>
    <p style="font-size: 14px; color: #616161; margin: 8px 0;">
      A quick view of baseline security controls (pass/fail/unknown). See Security Posture Findings for details.
    </p>
    <table>
      <thead>
        <tr>
          <th>Control</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        
        <tr>
          <td>Root MFA + no root keys</td>
          <td>
            <span class="scorecard-status scorecard-fail">
              FAIL
            </span>
          </td>
        </tr>
        
        <tr>
          <td>Password policy baseline</td>
          <td>
            <span class="scorecard-status scorecard-fail">
              FAIL
            </span>
          </td>
        </tr>
        
        <tr>
          <td>Access key hygiene</td>
          <td>
            <span class="scorecard-status scorecard-pass">
              PASS
            </span>
          </td>
        </tr>
        
        <tr>
          <td>S3 account public access block</td>
          <td>
            <span class="scorecard-status scorecard-fail">
              FAIL
            </span>
          </td>
        </tr>
        
        <tr>
          <td>S3 default encryption</td>
          <td>
            <span class="scorecard-status scorecard-pass">
              PASS
            </span>
          </td>
        </tr>
        
        <tr>
          <td>EBS encryption by default</td>
          <td>
            <span class="scorecard-status scorecard-pass">
              PASS
            </span>
          </td>
        </tr>
        
        <tr>
          <td>CloudTrail baseline</td>
          <td>
            <span class="scorecard-status scorecard-fail">
              FAIL
            </span>
          </td>
        </tr>
        
        <tr>
          <td>AWS Config recorder</td>
          <td>
            <span class="scorecard-status scorecard-pass">
              PASS
            </span>
          </td>
        </tr>
        
        <tr>
          <td>GuardDuty enabled</td>
          <td>
            <span class="scorecard-status scorecard-fail">
              FAIL
            </span>
          </td>
        </tr>
        
        <tr>
          <td>Security Hub enabled</td>
          <td>
            <span class="scorecard-status scorecard-pass">
              PASS
            </span>
          </td>
        </tr>
        
        <tr>
          <td>CloudWatch alarms present</td>
          <td>
            <span class="scorecard-status scorecard-pass">
              PASS
            </span>
          </td>
        </tr>
        
      </tbody>
    </table>
    

    
    
    
    
    <!-- Top Savings Opportunities -->
    <h3>üéØ Top Savings Opportunities</h3>
    <ul style="font-size: 14px; line-height: 1.8;">
      
        <li>
          <strong>underutilized_rds</strong> (prod-postgres-db) ‚Äî 
          <span style="color: #1976d2; font-weight: 600;">$78.0/month</span>
          via review-and-rightsize
          
          
            <br><small style="color: #666; margin-left: 20px; font-style: italic;">Metric query skipped due to budget exhaustion</small>
          
        </li>
      
        <li>
          <strong>idle_ec2</strong> (i-0123456789abcdef0) ‚Äî 
          <span style="color: #1976d2; font-weight: 600;">$62.4/month</span>
          via consider-stopping-or-rightsize
          
          
            <br><small style="color: #666; margin-left: 20px; font-style: italic;">Low CPU and low network usage over the lookback window.</small>
          
        </li>
      
        <li>
          <strong>unattached_ebs</strong> (vol-fedcba9876543210) ‚Äî 
          <span style="color: #1976d2; font-weight: 600;">$50.0/month</span>
          via snapshot-and-delete
          
          
            <br><small style="color: #666; margin-left: 20px; font-style: italic;">EBS volume (500 GB) unattached for >7 days. Create snapshot for safety, then delete if unused.</small>
          
        </li>
      
        <li>
          <strong>old_snapshot</strong> (snap-old123456789abc) ‚Äî 
          <span style="color: #1976d2; font-weight: 600;">$25.0/month</span>
          via delete-snapshot
          
          
            <br><small style="color: #666; margin-left: 20px; font-style: italic;">Snapshot is older than the retention window.</small>
          
        </li>
      
        <li>
          <strong>idle_elb</strong> (my-alb-prod) ‚Äî 
          <span style="color: #1976d2; font-weight: 600;">$25.0/month</span>
          via review-and-delete-if-unused
          
          
            <br><small style="color: #666; margin-left: 20px; font-style: italic;">Low request count over the lookback window.</small>
          
        </li>
      
    </ul>

    <!-- Cost Breakdown Chart -->
    
    <h2>Resource Distribution</h2>
    <div class="chart-container">
      <canvas id="costChart"></canvas>
    </div>
    <script>
      const ctx = document.getElementById('costChart').getContext('2d');
      new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ['account', 'security-group', 'ec2', 'ebs', 'snapshot', 'cloudwatch', 'lambda', 'eip', 'nat', 'elb', 'rds'],
          datasets: [{
            data: [6, 1, 1, 3, 2, 1, 1, 2, 1, 2, 2],
            backgroundColor: [
              '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
              '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#FF9F40'
            ]
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom'
            },
            title: {
              display: true,
              text: 'Resources by Type'
            }
          }
        }
      });
    </script>
    

    <!-- Priority Implementation Roadmap -->
    
    
    
    
    <h2>üìã Implementation Roadmap</h2>
    <div class="priority-grid">
      
      <div class="priority-box critical">
        <h3 style="color: #c62828;">üî• Critical Priority (3)</h3>
        <ul>
          
            <li>
              enable-root-mfa
              
            </li>
          
            <li>
              remove-root-access-keys
              
            </li>
          
            <li>
              consider-stopping-or-rightsize
              
                <br><small style="color: #1565c0;">üí∞ Save $62.4/month</small>
              
            </li>
          
        </ul>
      </div>
      
      
      
      <div class="priority-box high">
        <h3 style="color: #e65100;">‚ö° High Priority (6)</h3>
        <ul>
          
            <li>
              enable-cloudtrail
              
            </li>
          
            <li>
              enable-s3-block-public-access
              
            </li>
          
            <li>
              restrict-security-group-ingress
              
            </li>
          
            <li>
              snapshot-and-delete
              
                <br><small style="color: #1565c0;">üí∞ Save $10.0/month</small>
              
            </li>
          
            <li>
              snapshot-and-delete
              
                <br><small style="color: #1565c0;">üí∞ Save $50.0/month</small>
              
            </li>
          
        </ul>
      </div>
      
    </div>
    

    <!-- Top 5 Quick Wins -->
    <h2>üí° Top 5 Quick Wins</h2>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Resource</th>
          <th>Region</th>
          <th>Est. Savings (USD/mo)</th>
          <th>Recommended Action</th>
        </tr>
      </thead>
      <tbody>
      
        <tr class="severity-medium">
          <td>underutilized_rds</td>
          <td style="font-family: monospace; font-size: 12px;">prod-postgres-db</td>
          <td>us-east-1</td>
          <td style="font-weight: 600; color: #1976d2;">
            $78.0
          </td>
          <td>review-and-rightsize</td>
        </tr>
      
        <tr class="severity-critical">
          <td>idle_ec2</td>
          <td style="font-family: monospace; font-size: 12px;">i-0123456789abcdef0</td>
          <td>us-east-1</td>
          <td style="font-weight: 600; color: #1976d2;">
            $62.4
          </td>
          <td>consider-stopping-or-rightsize</td>
        </tr>
      
        <tr class="severity-high">
          <td>unattached_ebs</td>
          <td style="font-family: monospace; font-size: 12px;">vol-fedcba9876543210</td>
          <td>us-west-2</td>
          <td style="font-weight: 600; color: #1976d2;">
            $50.0
          </td>
          <td>snapshot-and-delete</td>
        </tr>
      
        <tr class="severity-medium">
          <td>old_snapshot</td>
          <td style="font-family: monospace; font-size: 12px;">snap-old123456789abc</td>
          <td>us-west-2</td>
          <td style="font-weight: 600; color: #1976d2;">
            $25.0
          </td>
          <td>delete-snapshot</td>
        </tr>
      
        <tr class="severity-high">
          <td>idle_elb</td>
          <td style="font-family: monospace; font-size: 12px;">my-alb-prod</td>
          <td>us-east-1</td>
          <td style="font-weight: 600; color: #1976d2;">
            $25.0
          </td>
          <td>review-and-delete-if-unused</td>
        </tr>
      
      </tbody>
    </table>

    <!-- Resource Counts -->
    <button class="collapsible">üìä Resource Counts by Type</button>
    <div class="content">
      <table style="margin-top: 16px;">
        <thead>
          <tr>
            <th>Resource Type</th>
            <th>Count</th>
          </tr>
        </thead>
        <tbody>
        
          <tr>
            <td>account</td>
            <td><strong>6</strong></td>
          </tr>
        
          <tr>
            <td>security-group</td>
            <td><strong>1</strong></td>
          </tr>
        
          <tr>
            <td>ec2</td>
            <td><strong>1</strong></td>
          </tr>
        
          <tr>
            <td>ebs</td>
            <td><strong>3</strong></td>
          </tr>
        
          <tr>
            <td>snapshot</td>
            <td><strong>2</strong></td>
          </tr>
        
          <tr>
            <td>cloudwatch</td>
            <td><strong>1</strong></td>
          </tr>
        
          <tr>
            <td>lambda</td>
            <td><strong>1</strong></td>
          </tr>
        
          <tr>
            <td>eip</td>
            <td><strong>2</strong></td>
          </tr>
        
          <tr>
            <td>nat</td>
            <td><strong>1</strong></td>
          </tr>
        
          <tr>
            <td>elb</td>
            <td><strong>2</strong></td>
          </tr>
        
          <tr>
            <td>rds</td>
            <td><strong>2</strong></td>
          </tr>
        
        </tbody>
      </table>
    </div>


    

    
    <button class="collapsible">üí∞ Financial Findings (15 total)</button>
    <div class="content">
      <table style="margin-top: 16px;">
        <thead>
          <tr>
            <th>Type</th>
            <th>Resource</th>
            <th>Region</th>
            <th>Severity</th>
            <th>Est. Cost (USD/mo)</th>
            <th>Est. Savings (USD/mo)</th>
            <th>Recommended Action</th>
            <th>Estimation</th>
          </tr>
        </thead>
        <tbody>
        
          <tr class="severity-medium">
            <td>
              underutilized_rds
              
                <span class="badge badge-info" title="Detection confidence">
                  75%
                </span>
              
              
              
              
              
                <span class="badge badge-skipped" title="Metric query skipped due to budget exhaustion">
                  Skipped
                </span>
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              prod-postgres-db
              
              
                <br><small style="color: #666;">db.t3.large
                
                  ‚Üí db.t3.medium
                
                </small>
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>156.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              78.0
              
            </td>
            <td>
              review-and-rightsize
              
                
                
              
              
                <br><small style="color: #666; font-style: italic;">Metric query skipped due to budget exhaustion</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws rds describe-db-instances --db-instance-identifier prod-postgres-db
aws cloudwatch get-metric-statistics --namespace AWS/RDS --metric-name CPUUtilization --dimensions Name=DBInstanceIdentifier,Value=prod-postgres-db --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-critical">
            <td>
              idle_ec2
              
                <span class="badge badge-info" title="Detection confidence">
                  95%
                </span>
              
              
                <span class="badge badge-cloudwatch" title="Measured via CloudWatch aggregate metrics">
                  Measured
                </span>
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              i-0123456789abcdef0
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-critical">
                CRITICAL
              </span>
            </td>
            <td>62.4</td>
            <td style="font-weight: 600; color: #1976d2;">
              62.4
              
            </td>
            <td>
              consider-stopping-or-rightsize
              
              
                <br><small style="color: #666; font-style: italic;">Low CPU and low network usage over the lookback window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws cloudwatch get-metric-statistics --namespace AWS/EC2 --metric-name CPUUtilization --dimensions Name=InstanceId,Value=i-0123456789abcdef0 --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average
aws cloudwatch get-metric-statistics --namespace AWS/EC2 --metric-name NetworkIn --dimensions Name=InstanceId,Value=i-0123456789abcdef0 --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              unattached_ebs
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              vol-fedcba9876543210
              
              
              
            </td>
            <td>us-west-2</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>50.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              50.0
              
            </td>
            <td>
              snapshot-and-delete
              
              
                <br><small style="color: #666; font-style: italic;">EBS volume (500 GB) unattached for >7 days. Create snapshot for safety, then delete if unused.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-volumes --volume-ids vol-fedcba9876543210
aws ec2 describe-volumes --filters Name=status,Values=available Name=volume-id,Values=vol-fedcba9876543210</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              idle_elb
              
                <span class="badge badge-info" title="Detection confidence">
                  90%
                </span>
              
              
                <span class="badge badge-cloudwatch" title="Measured via CloudWatch aggregate metrics">
                  Measured
                </span>
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              my-alb-prod
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>25.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              25.0
              
            </td>
            <td>
              review-and-delete-if-unused
              
              
                <br><small style="color: #666; font-style: italic;">Low request count over the lookback window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws cloudwatch get-metric-statistics --namespace AWS/ApplicationELB --metric-name RequestCount --dimensions Name=LoadBalancer,Value=app/my-alb-prod/1234567890abcdef --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 86400 --statistics Sum</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              old_snapshot
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              snap-old123456789abc
              
              
              
                <br><small style="color: #666;">964 days old</small>
              
            </td>
            <td>us-west-2</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>25.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              25.0
              
            </td>
            <td>
              delete-snapshot
              
              
                <br><small style="color: #666; font-style: italic;">Snapshot is older than the retention window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-snapshots --snapshot-ids snap-old123456789abc</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              unattached_ebs
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              vol-0123456789abcdef
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>10.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              10.0
              
            </td>
            <td>
              snapshot-and-delete
              
              
                <br><small style="color: #666; font-style: italic;">EBS volume (100 GB) unattached for >7 days. Create snapshot for safety, then delete if unused.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-volumes --volume-ids vol-0123456789abcdef
aws ec2 describe-volumes --filters Name=status,Values=available Name=volume-id,Values=vol-0123456789abcdef</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              cloudwatch_logs_retention
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              /aws/lambda/data-processor
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>15.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              9.0
              
            </td>
            <td>
              set-logs-retention
              
              
                <br><small style="color: #666; font-style: italic;">Log group retention is set to Never Expire; set retention to reduce storage costs.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws logs describe-log-groups --log-group-name-prefix /aws/lambda/data-processor --query &#39;logGroups[0].retentionInDays&#39;</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              gp2_to_gp3_migration
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              vol-1111222233334444
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>25.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              5.0
              
            </td>
            <td>
              migrate-to-gp3
              
              
                <br><small style="color: #666; font-style: italic;">gp3 is typically cheaper than gp2 for similar workloads.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-volumes --volume-ids vol-1111222233334444 --query &#39;Volumes[0].VolumeType&#39;
aws ec2 describe-volumes-modifications --volume-id vol-1111222233334444</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              old_snapshot
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              snap-0123456789abcdef
              
              
              
                <br><small style="color: #666;">668 days old</small>
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>5.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              5.0
              
            </td>
            <td>
              delete-snapshot
              
              
                <br><small style="color: #666; font-style: italic;">Snapshot is older than the retention window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-snapshots --snapshot-ids snap-0123456789abcdef</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              unused_eip
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              54.123.45.67
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>4.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              4.0
              
            </td>
            <td>
              release-eip
              
              
                <br><small style="color: #666; font-style: italic;">Elastic IP is not attached to any instance; AWS charges for unused EIPs.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-addresses --public-ips 54.123.45.67</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              unused_eip
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              34.210.98.76
              
              
              
            </td>
            <td>us-west-2</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>4.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              4.0
              
            </td>
            <td>
              release-eip
              
              
                <br><small style="color: #666; font-style: italic;">Elastic IP is not attached to any instance; AWS charges for unused EIPs.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-addresses --public-ips 34.210.98.76</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              overprovisioned_lambda
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              data-transformer
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>12.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              3.0
              
            </td>
            <td>
              reduce-lambda-memory
              
              
                <br><small style="color: #666; font-style: italic;">Execution time indicates memory may be over-provisioned.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws lambda get-function-configuration --function-name data-transformer --query &#39;MemorySize&#39;
aws cloudwatch get-metric-statistics --namespace AWS/Lambda --metric-name Duration --dimensions Name=FunctionName,Value=data-transformer --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              idle_elb
              
                <span class="badge badge-info" title="Detection confidence">
                  35%
                </span>
              
              
              
                <span class="tip">
                  <span class="badge badge-info">No Data</span>
                  <span class="tiptext">CloudWatch returned no datapoints for the lookback window.</span>
                </span>
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              my-alb-staging
              
              
              
            </td>
            <td>us-west-2</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>0.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              0.0
              
            </td>
            <td>
              review-lb-usage
              
              
                <br><small style="color: #666; font-style: italic;">Unable to measure load balancer request volume: CloudWatch returned no datapoints for the lookback window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws cloudwatch get-metric-statistics --namespace AWS/ApplicationELB --metric-name RequestCount --dimensions Name=LoadBalancer,Value=app/my-alb-staging/abcdef1234567890 --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 86400 --statistics Sum</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              nat_gateway
              
                <span class="badge badge-info" title="Detection confidence">
                  70%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              nat-0123456789abcdef
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>32.85</td>
            <td style="font-weight: 600; color: #1976d2;">
              0.0
              
            </td>
            <td>
              review-and-consider-vpc-endpoint
              
              
                <br><small style="color: #666; font-style: italic;">NAT gateways have hourly + data processing cost; if used primarily for S3, consider an S3 VPC endpoint.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-nat-gateways --nat-gateway-ids nat-0123456789abcdef
aws ec2 describe-route-tables --filters Name=route.nat-gateway-id,Values=nat-0123456789abcdef</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                
                
                
                
                <span class="tip">
                  <span class="badge badge-info">üìê Estimation</span>
                  <span class="tiptext">Method: base_hourly+uptime ‚Ä¢ Adjusted cost: $32.85/mo ‚Ä¢ Assumptions: ['no data processing included', 'uptime estimated from CreateTime', 'regional multiplier applied via pricing tables']</span>
                </span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              underutilized_rds
              
                <span class="badge badge-info" title="Detection confidence">
                  30%
                </span>
              
              
              
              
                <span class="tip">
                  <span class="badge badge-info">Access Denied</span>
                  <span class="tiptext">Missing CloudWatch permissions to read metrics for this resource.</span>
                </span>
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              analytics-postgres-db
              
              
                <br><small style="color: #666;">db.t3.large
                
                </small>
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>0.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              0.0
              
            </td>
            <td>
              review-and-rightsize
              
                
                
              
              
                <br><small style="color: #666; font-style: italic;">Unable to measure CPU/storage utilization: missing CloudWatch permissions (AccessDenied).</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws rds describe-db-instances --db-instance-identifier analytics-postgres-db
aws cloudwatch get-metric-statistics --namespace AWS/RDS --metric-name CPUUtilization --dimensions Name=DBInstanceIdentifier,Value=analytics-postgres-db --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
        </tbody>
      </table>
    </div>
    

    
    <button class="collapsible">üõ°Ô∏è Security Posture Findings (7 total)</button>
    <div class="content">
      <table style="margin-top: 16px;">
        <thead>
          <tr>
            <th>Type</th>
            <th>Resource</th>
            <th>Region</th>
            <th>Severity</th>
            <th>Est. Cost (USD/mo)</th>
            <th>Est. Savings (USD/mo)</th>
            <th>Recommended Action</th>
            <th>Estimation</th>
          </tr>
        </thead>
        <tbody>
        
          <tr class="severity-critical">
            <td>
              iam_root_access_keys_present
              
                <span class="badge badge-info" title="Detection confidence">
                  100%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              root
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-critical">
                CRITICAL
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              remove-root-access-keys
              
              
                <br><small style="color: #666; font-style: italic;">Root access keys are present. Delete root access keys and use least-privilege IAM roles/users.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws iam get-account-summary --query &#39;SummaryMap.AccountAccessKeysPresent&#39;</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-critical">
            <td>
              iam_root_mfa_disabled
              
                <span class="badge badge-info" title="Detection confidence">
                  100%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              root
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-critical">
                CRITICAL
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              enable-root-mfa
              
              
                <br><small style="color: #666; font-style: italic;">Root MFA is not enabled. Enable MFA on the root user and restrict root usage.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws iam get-account-summary --query &#39;SummaryMap.AccountMFAEnabled&#39;</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              cloudtrail_not_configured
              
                <span class="badge badge-info" title="Detection confidence">
                  90%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              account
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              enable-cloudtrail
              
              
                <br><small style="color: #666; font-style: italic;">CloudTrail baseline appears incomplete. Enable an org/account trail (multi-region) and ensure it is actively logging.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws cloudtrail describe-trails
aws cloudtrail get-trail-status --name &lt;trail-name&gt;</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              s3_account_public_access_block_disabled
              
                <span class="badge badge-info" title="Detection confidence">
                  90%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              account
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              enable-s3-block-public-access
              
              
                <br><small style="color: #666; font-style: italic;">S3 account-level Block Public Access is not fully enabled.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws s3control get-public-access-block --account-id 123456789012</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              sg_open_to_world
              
                <span class="badge badge-info" title="Detection confidence">
                  95%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              sg-0123abcd4567efgh8
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              restrict-security-group-ingress
              
              
                <br><small style="color: #666; font-style: italic;">Security group allows inbound access from the public internet on sensitive ports.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-security-groups --group-ids sg-0123abcd4567efgh8
aws ec2 describe-security-group-rules --filters Name=group-id,Values=sg-0123abcd4567efgh8</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              guardduty_not_enabled
              
                <span class="badge badge-info" title="Detection confidence">
                  80%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              account
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              enable-guardduty
              
              
                <br><small style="color: #666; font-style: italic;">GuardDuty is not enabled in one or more regions checked.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws guardduty list-detectors --region us-east-1
aws guardduty list-detectors --region us-west-2</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              iam_password_policy_weak
              
                <span class="badge badge-info" title="Detection confidence">
                  95%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              account
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              harden-iam-password-policy
              
              
                <br><small style="color: #666; font-style: italic;">IAM password policy is weaker than common baseline settings.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws iam get-account-password-policy</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
        </tbody>
      </table>
    </div>
    

    

    <!-- All Findings (Collapsible) -->
    <button class="collapsible">üîç All Findings (22 total)</button>
    <div class="content">
      <table style="margin-top: 16px;">
        <thead>
          <tr>
            <th>Type</th>
            <th>Resource</th>
            <th>Region</th>
            <th>Severity</th>
            <th>Est. Cost (USD/mo)</th>
            <th>Est. Savings (USD/mo)</th>
            <th>Recommended Action</th>
            <th>Estimation</th>
          </tr>
        </thead>
        <tbody>
        
          <tr class="severity-critical">
            <td>
              iam_root_mfa_disabled
              
                <span class="badge badge-info" title="Detection confidence">
                  100%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              root
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-critical">
                CRITICAL
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              enable-root-mfa
              
              
                <br><small style="color: #666; font-style: italic;">Root MFA is not enabled. Enable MFA on the root user and restrict root usage.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws iam get-account-summary --query &#39;SummaryMap.AccountMFAEnabled&#39;</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-critical">
            <td>
              iam_root_access_keys_present
              
                <span class="badge badge-info" title="Detection confidence">
                  100%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              root
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-critical">
                CRITICAL
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              remove-root-access-keys
              
              
                <br><small style="color: #666; font-style: italic;">Root access keys are present. Delete root access keys and use least-privilege IAM roles/users.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws iam get-account-summary --query &#39;SummaryMap.AccountAccessKeysPresent&#39;</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              iam_password_policy_weak
              
                <span class="badge badge-info" title="Detection confidence">
                  95%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              account
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              harden-iam-password-policy
              
              
                <br><small style="color: #666; font-style: italic;">IAM password policy is weaker than common baseline settings.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws iam get-account-password-policy</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              cloudtrail_not_configured
              
                <span class="badge badge-info" title="Detection confidence">
                  90%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              account
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              enable-cloudtrail
              
              
                <br><small style="color: #666; font-style: italic;">CloudTrail baseline appears incomplete. Enable an org/account trail (multi-region) and ensure it is actively logging.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws cloudtrail describe-trails
aws cloudtrail get-trail-status --name &lt;trail-name&gt;</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              s3_account_public_access_block_disabled
              
                <span class="badge badge-info" title="Detection confidence">
                  90%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              account
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              enable-s3-block-public-access
              
              
                <br><small style="color: #666; font-style: italic;">S3 account-level Block Public Access is not fully enabled.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws s3control get-public-access-block --account-id 123456789012</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              sg_open_to_world
              
                <span class="badge badge-info" title="Detection confidence">
                  95%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              sg-0123abcd4567efgh8
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              restrict-security-group-ingress
              
              
                <br><small style="color: #666; font-style: italic;">Security group allows inbound access from the public internet on sensitive ports.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-security-groups --group-ids sg-0123abcd4567efgh8
aws ec2 describe-security-group-rules --filters Name=group-id,Values=sg-0123abcd4567efgh8</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              guardduty_not_enabled
              
                <span class="badge badge-info" title="Detection confidence">
                  80%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              account
              
              
              
            </td>
            <td>None</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>None</td>
            <td style="font-weight: 600; color: #1976d2;">
              0
              
            </td>
            <td>
              enable-guardduty
              
              
                <br><small style="color: #666; font-style: italic;">GuardDuty is not enabled in one or more regions checked.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws guardduty list-detectors --region us-east-1
aws guardduty list-detectors --region us-west-2</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-critical">
            <td>
              idle_ec2
              
                <span class="badge badge-info" title="Detection confidence">
                  95%
                </span>
              
              
                <span class="badge badge-cloudwatch" title="Measured via CloudWatch aggregate metrics">
                  Measured
                </span>
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              i-0123456789abcdef0
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-critical">
                CRITICAL
              </span>
            </td>
            <td>62.4</td>
            <td style="font-weight: 600; color: #1976d2;">
              62.4
              
            </td>
            <td>
              consider-stopping-or-rightsize
              
              
                <br><small style="color: #666; font-style: italic;">Low CPU and low network usage over the lookback window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws cloudwatch get-metric-statistics --namespace AWS/EC2 --metric-name CPUUtilization --dimensions Name=InstanceId,Value=i-0123456789abcdef0 --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average
aws cloudwatch get-metric-statistics --namespace AWS/EC2 --metric-name NetworkIn --dimensions Name=InstanceId,Value=i-0123456789abcdef0 --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              unattached_ebs
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              vol-0123456789abcdef
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>10.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              10.0
              
            </td>
            <td>
              snapshot-and-delete
              
              
                <br><small style="color: #666; font-style: italic;">EBS volume (100 GB) unattached for >7 days. Create snapshot for safety, then delete if unused.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-volumes --volume-ids vol-0123456789abcdef
aws ec2 describe-volumes --filters Name=status,Values=available Name=volume-id,Values=vol-0123456789abcdef</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              unattached_ebs
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              vol-fedcba9876543210
              
              
              
            </td>
            <td>us-west-2</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>50.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              50.0
              
            </td>
            <td>
              snapshot-and-delete
              
              
                <br><small style="color: #666; font-style: italic;">EBS volume (500 GB) unattached for >7 days. Create snapshot for safety, then delete if unused.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-volumes --volume-ids vol-fedcba9876543210
aws ec2 describe-volumes --filters Name=status,Values=available Name=volume-id,Values=vol-fedcba9876543210</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              gp2_to_gp3_migration
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              vol-1111222233334444
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>25.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              5.0
              
            </td>
            <td>
              migrate-to-gp3
              
              
                <br><small style="color: #666; font-style: italic;">gp3 is typically cheaper than gp2 for similar workloads.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-volumes --volume-ids vol-1111222233334444 --query &#39;Volumes[0].VolumeType&#39;
aws ec2 describe-volumes-modifications --volume-id vol-1111222233334444</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              old_snapshot
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              snap-old123456789abc
              
              
              
                <br><small style="color: #666;">964 days old</small>
              
            </td>
            <td>us-west-2</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>25.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              25.0
              
            </td>
            <td>
              delete-snapshot
              
              
                <br><small style="color: #666; font-style: italic;">Snapshot is older than the retention window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-snapshots --snapshot-ids snap-old123456789abc</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              cloudwatch_logs_retention
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              /aws/lambda/data-processor
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>15.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              9.0
              
            </td>
            <td>
              set-logs-retention
              
              
                <br><small style="color: #666; font-style: italic;">Log group retention is set to Never Expire; set retention to reduce storage costs.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws logs describe-log-groups --log-group-name-prefix /aws/lambda/data-processor --query &#39;logGroups[0].retentionInDays&#39;</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              overprovisioned_lambda
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              data-transformer
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>12.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              3.0
              
            </td>
            <td>
              reduce-lambda-memory
              
              
                <br><small style="color: #666; font-style: italic;">Execution time indicates memory may be over-provisioned.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws lambda get-function-configuration --function-name data-transformer --query &#39;MemorySize&#39;
aws cloudwatch get-metric-statistics --namespace AWS/Lambda --metric-name Duration --dimensions Name=FunctionName,Value=data-transformer --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              unused_eip
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              54.123.45.67
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>4.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              4.0
              
            </td>
            <td>
              release-eip
              
              
                <br><small style="color: #666; font-style: italic;">Elastic IP is not attached to any instance; AWS charges for unused EIPs.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-addresses --public-ips 54.123.45.67</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              unused_eip
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              34.210.98.76
              
              
              
            </td>
            <td>us-west-2</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>4.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              4.0
              
            </td>
            <td>
              release-eip
              
              
                <br><small style="color: #666; font-style: italic;">Elastic IP is not attached to any instance; AWS charges for unused EIPs.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-addresses --public-ips 34.210.98.76</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              nat_gateway
              
                <span class="badge badge-info" title="Detection confidence">
                  70%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              nat-0123456789abcdef
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>32.85</td>
            <td style="font-weight: 600; color: #1976d2;">
              0.0
              
            </td>
            <td>
              review-and-consider-vpc-endpoint
              
              
                <br><small style="color: #666; font-style: italic;">NAT gateways have hourly + data processing cost; if used primarily for S3, consider an S3 VPC endpoint.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-nat-gateways --nat-gateway-ids nat-0123456789abcdef
aws ec2 describe-route-tables --filters Name=route.nat-gateway-id,Values=nat-0123456789abcdef</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                
                
                
                
                <span class="tip">
                  <span class="badge badge-info">üìê Estimation</span>
                  <span class="tiptext">Method: base_hourly+uptime ‚Ä¢ Adjusted cost: $32.85/mo ‚Ä¢ Assumptions: ['no data processing included', 'uptime estimated from CreateTime', 'regional multiplier applied via pricing tables']</span>
                </span>
              
            </td>
          </tr>
        
          <tr class="severity-high">
            <td>
              idle_elb
              
                <span class="badge badge-info" title="Detection confidence">
                  90%
                </span>
              
              
                <span class="badge badge-cloudwatch" title="Measured via CloudWatch aggregate metrics">
                  Measured
                </span>
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              my-alb-prod
              
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-high">
                HIGH
              </span>
            </td>
            <td>25.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              25.0
              
            </td>
            <td>
              review-and-delete-if-unused
              
              
                <br><small style="color: #666; font-style: italic;">Low request count over the lookback window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws cloudwatch get-metric-statistics --namespace AWS/ApplicationELB --metric-name RequestCount --dimensions Name=LoadBalancer,Value=app/my-alb-prod/1234567890abcdef --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 86400 --statistics Sum</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              idle_elb
              
                <span class="badge badge-info" title="Detection confidence">
                  35%
                </span>
              
              
              
                <span class="tip">
                  <span class="badge badge-info">No Data</span>
                  <span class="tiptext">CloudWatch returned no datapoints for the lookback window.</span>
                </span>
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              my-alb-staging
              
              
              
            </td>
            <td>us-west-2</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>0.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              0.0
              
            </td>
            <td>
              review-lb-usage
              
              
                <br><small style="color: #666; font-style: italic;">Unable to measure load balancer request volume: CloudWatch returned no datapoints for the lookback window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws cloudwatch get-metric-statistics --namespace AWS/ApplicationELB --metric-name RequestCount --dimensions Name=LoadBalancer,Value=app/my-alb-staging/abcdef1234567890 --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 86400 --statistics Sum</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-medium">
            <td>
              underutilized_rds
              
                <span class="badge badge-info" title="Detection confidence">
                  75%
                </span>
              
              
              
              
              
                <span class="badge badge-skipped" title="Metric query skipped due to budget exhaustion">
                  Skipped
                </span>
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              prod-postgres-db
              
              
                <br><small style="color: #666;">db.t3.large
                
                  ‚Üí db.t3.medium
                
                </small>
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-medium">
                MEDIUM
              </span>
            </td>
            <td>156.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              78.0
              
            </td>
            <td>
              review-and-rightsize
              
                
                
              
              
                <br><small style="color: #666; font-style: italic;">Metric query skipped due to budget exhaustion</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws rds describe-db-instances --db-instance-identifier prod-postgres-db
aws cloudwatch get-metric-statistics --namespace AWS/RDS --metric-name CPUUtilization --dimensions Name=DBInstanceIdentifier,Value=prod-postgres-db --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              underutilized_rds
              
                <span class="badge badge-info" title="Detection confidence">
                  30%
                </span>
              
              
              
              
                <span class="tip">
                  <span class="badge badge-info">Access Denied</span>
                  <span class="tiptext">Missing CloudWatch permissions to read metrics for this resource.</span>
                </span>
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              analytics-postgres-db
              
              
                <br><small style="color: #666;">db.t3.large
                
                </small>
              
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>0.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              0.0
              
            </td>
            <td>
              review-and-rightsize
              
                
                
              
              
                <br><small style="color: #666; font-style: italic;">Unable to measure CPU/storage utilization: missing CloudWatch permissions (AccessDenied).</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws rds describe-db-instances --db-instance-identifier analytics-postgres-db
aws cloudwatch get-metric-statistics --namespace AWS/RDS --metric-name CPUUtilization --dimensions Name=DBInstanceIdentifier,Value=analytics-postgres-db --start-time $(date -u -v-7d &#39;+%Y-%m-%dT%H:%M:%S&#39;) --end-time $(date -u &#39;+%Y-%m-%dT%H:%M:%S&#39;) --period 3600 --statistics Average</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
          <tr class="severity-low">
            <td>
              old_snapshot
              
                <span class="badge badge-info" title="Detection confidence">
                  50%
                </span>
              
              
              
              
              
            </td>
            <td style="font-family: monospace; font-size: 12px;">
              snap-0123456789abcdef
              
              
              
                <br><small style="color: #666;">668 days old</small>
              
            </td>
            <td>us-east-1</td>
            <td>
              <span class="badge badge-low">
                LOW
              </span>
            </td>
            <td>5.0</td>
            <td style="font-weight: 600; color: #1976d2;">
              5.0
              
            </td>
            <td>
              delete-snapshot
              
              
                <br><small style="color: #666; font-style: italic;">Snapshot is older than the retention window.</small>
              
              
                <details style="margin-top: 6px;">
                  <summary style="cursor: pointer; font-size: 12px; color: #1976d2;">Verify (AWS CLI)</summary>
                  <div class="codeblock" role="button" aria-label="Copy AWS CLI commands">
                    <button class="copy-btn" type="button">Copy</button>
                    <code>aws ec2 describe-snapshots --snapshot-ids snap-0123456789abcdef</code>
                  </div>
                </details>
              
            </td>
            <td>
              
              
              
              
                <span class="badge badge-heuristic" title="Static pricing/heuristics">Heuristic</span>
              
            </td>
          </tr>
        
        </tbody>
      </table>
    </div>

    <p style="margin-top: 24px; font-size: 13px; color: #757575;">
      <em>üìÅ CSV export available:</em> findings.csv generated alongside this report.
    </p>

    <!-- Footer -->
    <div class="footer">
      <p>
        <strong>Privacy Note:</strong> StackSage uses aggregate CloudWatch metrics (e.g., Average CPUUtilization, RequestCount), 
        Cost Explorer totals, and public Pricing metadata. No object contents, application payloads, or sensitive data are accessed. 
        S3 lifecycle savings are heuristic estimates without accessing object sizes.
      </p>
      <p style="margin-top: 12px;">
        Generated by <strong>StackSage</strong> ‚Ä¢ Report any issues to hello@stacksage.io
      </p>
    </div>

    <!-- Collapsible sections script -->
    <script>
      document.querySelectorAll('.collapsible').forEach(btn => {
        btn.addEventListener('click', function() {
          this.classList.toggle('active');
          const content = this.nextElementSibling;
          if (content.style.maxHeight) {
            content.style.maxHeight = null;
            content.classList.remove('expanded');
          } else {
            content.classList.add('expanded');
            content.style.maxHeight = content.scrollHeight + 'px';
          }
        });
      });

      document.querySelectorAll('.codeblock').forEach(block => {
        const button = block.querySelector('.copy-btn');
        const code = block.querySelector('code');
        const copy = () => {
          const text = code.innerText;
          navigator.clipboard.writeText(text).then(() => {
            button.classList.add('copied');
            button.textContent = 'Copied';
            setTimeout(() => {
              button.classList.remove('copied');
              button.textContent = 'Copy';
            }, 1500);
          }).catch(() => {
            button.textContent = 'Select';
          });
        };
        button.addEventListener('click', (e) => {
          e.stopPropagation();
          copy();
        });
        block.addEventListener('click', copy);
      });
    </script>
  </div>
</body>
</html>